echo "Running type check..."
bun run type-check || exit 1

CHANGED_FILES=$(git diff --name-only --diff-filter=d origin/main...HEAD | grep -v "^packages/dashboard/")

if [ -n "$CHANGED_FILES" ]; then
  echo "Running tests related to changed files..."
  bun run --filter devflow-mcp test || exit 1
else
  echo "No changed files detected (or only dashboard files), skipping tests..."
fi

echo "âœ“ Pre-push checks passed"
